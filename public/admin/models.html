<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>後台 - 公式編輯器</title>
  <link rel="stylesheet" href="/assets/app.css" />
  <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
</head>
<body>
  <div class="card">
    <a href="/map.html">← 回地圖</a>
    <h2>公式編輯器（V2）</h2>
    <div class="row">
      <div>
        <label class="small">材料（Material）</label>
        <select id="materialId"></select>
      </div>
      <div>
        <label class="small">指標（Metric）</label>
        <select id="metric"></select>
      </div>
      <div>
        <label class="small">版本（Version）</label>
        <input id="version" value="v2" />
      </div>
    </div>
    <label class="small">公式（Expression）</label>
    <textarea id="expression" rows="4"></textarea>
    <label class="small">參數 JSON（Parameters）</label>
    <textarea id="params" rows="4">{}</textarea>
    <div class="row">
      <div>
        <label class="small">測試 r（比例）</label>
        <input id="testR" type="number" min="0" max="1" step="0.01" value="0.3" />
      </div>
      <div>
        <label class="small">測試 p（製程）</label>
        <input id="testP" type="number" min="0" max="1" step="0.01" value="0.5" />
      </div>
    </div>
    <div class="row">
      <button id="btnTest">測試公式</button>
      <button id="btnSurface">3D 預覽曲面</button>
      <button id="btnSave">儲存新版本</button>
      <button id="btnSetActive">設為啟用版本</button>
    </div>
    <div id="msg" class="small"></div>
  </div>
  <div class="card">
    <div class="small">歷史版本</div>
    <div id="versions"></div>
  </div>
  <div class="card">
    <div id="surfacePlot" style="height:380px;"></div>
  </div>

  <script type="module" src="/admin/js/admin-models.js"></script>
</body>
</html>
