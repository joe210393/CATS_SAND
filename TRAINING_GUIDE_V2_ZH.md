# CATS-SAND V2 教育訓練手冊（白話版）

這份文件是給現場操作人員用的，不需要程式背景也能上手。

---

## 1) 先理解一句話：系統在做什麼？

你可以把系統想成「配方試驗模擬器」：

- 你給它材料 + 比例（BOM）
- 系統用每個材料自己的公式去算分數
- 再把分數合成成 8 個指標 + XYZ
- 你可以在地圖看點位，也可以反推新配方

---

## 2) 什麼是「公式」？

### 白話說法

公式就是「某材料在某個功能上的表現規則」。

例如同一個材料：
- 在「除臭」可能很強
- 在「吸水」可能普通
- 在「抗粉碎」可能偏弱

這三個功能本來就不會一樣，所以公式會不一樣。

---

## 3) 每一個材料的公式可以不一樣嗎？

**可以，而且本來就應該不一樣。**

系統結構是：
- 每個材料（material）
- 每個指標（metric）
- 各有一條可編輯公式（expression）

所以「A 材料的除臭公式」可以跟「B 材料的除臭公式」完全不同；
同一材料的「除臭公式」也可以跟它自己的「吸水公式」不同。

---

## 4) 參數是什麼？（A / k / b / p / r）

目前常見參數白話解讀：

- `r`：該材料在配方中的比例（0~1）
- `p`：製程參數（0~1，可理解成工藝條件）
- `A`：影響上限強度（天花板）
- `k`：影響起效速度（比例增加時爬升多快）
- `b`：影響高比例時的懲罰（太高時是否掉分）

常見預設公式：

`sat(A*(1-exp(-k*r))*(1-b*r))`

白話：
- 前段比例增加時，分數先快速上升
- 到高比例時會趨緩
- 如果 `b` 較高，比例過高可能開始扣分

---

## 5) 為什麼不能手填 XYZ？

V2 的規則是「以 BOM 為真相」：

- 只要 BOM 變了，XYZ 應該跟著變
- 如果允許手填 XYZ，會跟 BOM 對不起來

所以現在做法是：
- 你改 BOM
- 系統自動用公式重算 XYZ
- map 點位跟著更新

---

## 6) 地圖頁常用操作（一步一步）

###[A] 點樣品看資料
1. 進 `map.html`
2. 點 3D 點雲中的某個樣品
3. 右側會顯示：
   - 樣品名稱
   - BOM 比例
   - 系統計算 XYZ
   - 8 指標

###[B] 用新公式重算全部舊樣品
1. 點「用新公式重算全部樣品分數」
2. 等待顯示完成筆數
3. 點位會更新到新公式結果

###[C] 看「同材料不同配比」的點位分布
1. 點一個樣品
2. 在「樣品混成比例 XYZ 曲面」設定：
   - 掃描點數
   - 變動強度
   - p 值
3. 點「生成樣品曲面/點雲」
4. 可做三件事：
   - 點「放大圖表」
   - 點「下載配比點配方 CSV」
   - 點圖上任一配比點，查看相對基準配方的調整量

###[D] 主次求解（找接近目標 XYZ 的配方）
1. 選主材料
2. 設主材比例範圍
3. 設目標 XYZ
4. 點「在地圖上產生主次候選配方」
5. 看候選清單與距離（distance）

###[E] 換主材補救
1. 選基準樣品
2. 選 A（舊主材）→ B（新主材）
3. 設目標 XYZ
4. 點「在地圖上計算換主材補救」
5. 看：
   - 替換前後 XYZ
   - 下降量
   - 建議補強材料
   - 補救候選配方

---

## 7) 公式測試比例要怎麼看？

在公式編輯頁（`/admin/models.html`）：

1. 選材料 + 指標
2. 輸入公式與參數 JSON
3. 設 `r` 與 `p`
4. 按「測試公式」看單點值
5. 按「3D 預覽曲面」看整體趨勢

建議測試方式：
- 固定 `p`，掃 `r`（看比例影響）
- 固定 `r`，掃 `p`（看製程敏感度）
- 確認曲線趨勢符合材料常識

---

## 8) 現場操作的三個建議

1. **先校公式再求解**  
   公式不準，後面優化再漂亮也會偏。

2. **用「基準配方」對照調整量**  
   配比點功能能直接看哪個材料加太多、哪個該補。

3. **每次只改一個因素**  
   先改主材比例，再改次材；不要一次全動，才看得懂因果。

---

## 9) 常見問答（FAQ）

### Q1：每個材料的每個指標公式都能不同嗎？
可以，這是系統設計重點。

### Q2：如果沒設定公式會怎樣？
系統會自動建立預設公式（不會覆蓋你已經手改的版本）。

### Q3：為什麼同樣材料組合，點位還是很多？
因為比例不同，公式算出來的 XYZ 就不同，這正是配方優化的空間。

